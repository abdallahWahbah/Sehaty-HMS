<!-- doctor-medicalrecordandprescription.component.html -->
<section id="dashboard" class="dashboard">
  <!-- Medical Record -->
  <div class="dashboard__title mb-4">
    <h2 class="dashboard__title-main">Medical Records</h2>
    <p class="dashboard__title-sub">
      Medical records related to: {{ medicalRecord?.patientName }}
    </p>

    <div
      *ngIf="medicalRecord; else noMedicalRecord"
      class="medical-record card p-4 mb-4 shadow-sm"
    >
      <div
        class="medical-record__header d-flex justify-content-between align-items-center mb-3"
      >
        <h3 class="medical-record__patient-name">
          {{ medicalRecord.patientName }}
        </h3>
        <span class="medical-record__record-type badge bg-primary">{{
          medicalRecord.recordType
        }}</span>
      </div>

      <div class="medical-record__dates d-flex gap-3 mb-3">
        <div>
          <strong>Record Date:</strong>
          {{ medicalRecord.recordDate | date : "yyyy-MM-dd HH:mm" }}
        </div>
        <div>
          <strong>Created At:</strong>
          {{ medicalRecord.createdAt | date : "yyyy-MM-dd HH:mm" }}
        </div>
      </div>

      <div class="medical-record__vitals row mb-3">
        <div class="col-md-3">
          <strong>BP:</strong> {{ medicalRecord.vitalBp }}
        </div>
        <div class="col-md-3">
          <strong>Temperature:</strong> {{ medicalRecord.temperature }} Â°C
        </div>
        <div class="col-md-3">
          <strong>Heart Rate:</strong> {{ medicalRecord.heartRate }} bpm
        </div>
        <div class="col-md-3">
          <strong>Weight:</strong> {{ medicalRecord.weight }} kg
        </div>
      </div>

      <div class="medical-record__details mb-3">
        <p><strong>Symptoms:</strong> {{ medicalRecord.symptoms }}</p>
        <p><strong>Diagnosis:</strong> {{ medicalRecord.diagnosis }}</p>
        <p>
          <strong>Treatment Plan:</strong> {{ medicalRecord.treatmentPlan }}
        </p>
        <p><strong>Notes:</strong> {{ medicalRecord.notes }}</p>
      </div>
    </div>

    <ng-template #noMedicalRecord>
      <p class="text-muted mt-4 text-center">No medical records found.</p>
    </ng-template>
  </div>

  <!-- Prescriptions -->
  <div class="dashboard__title mb-3">
    <h2 class="dashboard__title-main">Prescriptions</h2>
  </div>

  <div *ngIf="!loading">
    <div *ngIf="prescriptions.length > 0; else noPrescriptions">
      <div
        *ngFor="let pres of prescriptions"
        class="card prescription-card mb-4 shadow-sm"
      >
        <div
          class="card-header bg-primary text-white d-flex justify-content-between align-items-center"
        >
          <div>
            <strong>Prescription ID:</strong> {{ pres.prescriptionId }} |
            <strong>Status:</strong> {{ pres.status }} |
            <strong>Date Issued:</strong>
            {{ pres.dateIssued | date : "medium" }}
          </div>
        </div>

        <div class="card-body">
          <p><strong>Doctor:</strong> Dr. {{ pres.doctorName }}</p>
          <p>
            <strong>Special Instructions:</strong>
            {{ pres.specialInstructions }}
          </p>

          <div
            *ngIf="pres.medicationNames.length > 0; else noMeds"
            class="medications mt-2"
          >
            <h5>Medications:</h5>
            <ul>
              <li *ngFor="let med of pres.medicationNames">{{ med }}</li>
            </ul>
          </div>

          <ng-template #noMeds>
            <p>-</p>
          </ng-template>
        </div>
      </div>
    </div>

    <ng-template #noPrescriptions>
      <div class="empty-state mt-4 text-center">
        <i
          class="fa-solid fa-prescription-bottle-medical fa-2x mb-2"
          style="color: #252b61"
        ></i>
        <p>No prescriptions found</p>
      </div>
    </ng-template>
  </div>
</section>
